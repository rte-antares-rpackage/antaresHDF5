{
    "collab_server" : "",
    "contents" : "library(rhdf5)\nlibrary(antaresRead)\nlibrary(data.table)\nlibrary(microbenchmark)\n\n\nsetSimulationPath(\"D:/exemple_test\", 1)\nres <- readAntares(areas = \"all\", links = \"all\", clusters = \"all\", districts = \"all\", mcYears = \"all\")\n#\n# saveRDS(res$areas[c(1:10)], \"ExempleDate.RDS\")\n#\n\nDTAB <- data.frame(res$areas[, .SD, .SDcols = 7:ncol(res$areas)])\nMAT <- as.matrix(res$areas[, .SD, .SDcols = 7:ncol(res$areas)])\n\n#Ecriture data.frame VS ecriture martice dans le cas ou uniquement numeriques\nmicrobenchmark(source(\"inst/dev/writeDataFrame.R\"),\n               source(\"inst/dev/writeMatrix.R\"))\n\nh5errorHandling(type=\"suppress\")\n#Mélange character et numerique\nDTAB <- data.frame(res$areas)\nMAT <- as.matrix(res$areas)\nMAT[,1] <- as.numeric(as.factor(MAT[,1] ))\nMAT[,3] <- as.numeric(as.factor(MAT[,3] ))\nMAT[,5] <- as.numeric(as.factor(MAT[,5] ))\nMAT[,6] <- as.numeric(as.factor(MAT[,6] ))\nMAT <- apply(MAT, 2, as.numeric)\n\n\nchaR <- data.frame(res$areas)[, c(1,3,5,6)]\nnuM <- apply(as.matrix(res$areas)[, -c(1,3,5,6)],2,as.numeric)\n\n#Cas 1 : écriture data.frame avec mélange char et num\n#Cas 2 : écriture matrice avec uniquement numerique (besoin de table de lien pour les variables facteurs)\n#Cas 3 : écriture de deux table 1, data.frame avec les colonnes charactère, table 2 matrice avec les colonnes numériques\nmicrobenchmark(source(\"inst/dev/writeDataFrame.R\"),\n               source(\"inst/dev/writeMatrix.R\"),\n               source(\"inst/dev/writeDataframeForCharAndMatriceForNum.R\")\n               )\n\n#Cas 1 rejeté\n#Hésisation entre cas 2 et cas 3, le cas 2 est plus complexe à mettre en place (table de lien)\n#pour des perfs casiment similaires\n\n\n###Utilisation des chunks\n#Sans chunk\nh5createFile(\"testNoChunk.h5\")\nh5write(MAT, \"testNoChunk.h5\",\"B\")\nH5close()\n\n#Avec chunk\nh5createFile(\"testChunk.h5\")\nh5createDataset(\"testChunk.h5\", \"B\",dim = dim(MAT),chunk=c(nrow(MAT),1))\nh5write(MAT, \"testChunk.h5\",\"B\")\nH5close()\n\n\nmicrobenchmark(h5read(\"testNoChunk.h5\", \"B\", index=list(NULL, 30)),\nh5read(\"testChunk.h5\", \"B\", index=list(NULL, 30)))\n\n#Préconisation : Pour un requêtage colonne faire des chunks\n\n\nfile.remove(\"testNoChunk.h5\")\nfile.remove(\"testChunk.h5\")\n\n\n\n",
    "created" : 1497515330692.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "4131151750",
    "id" : "DE1076D8",
    "lastKnownWriteTime" : 1497872325,
    "last_content_update" : 1497872325194,
    "path" : "D:/Users/titorobe/Desktop/Antares/antaresHdf5/inst/dev/benchmark.R",
    "project_path" : "inst/dev/benchmark.R",
    "properties" : {
        "tempName" : "Untitled1"
    },
    "relative_order" : 2,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_source"
}