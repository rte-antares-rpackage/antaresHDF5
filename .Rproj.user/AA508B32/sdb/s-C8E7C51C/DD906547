{
    "collab_server" : "",
    "contents" : "library(rhdf5)\n\nv <- rnorm(100000000)\n\nh5createFile(\"write_full_double.h5\")\nh5write(v, \"write_full_double.h5\",\"B\")\nh5ls(\"write_full_double.h5\")\n\nfile.info(\"write_full_double.h5\")\nv2 <- h5read(\"write_full_double.h5\",\"B\")\nhead(v2)\n\nh5createFile(\"write_full_double_round3.h5\")\nh5write(round(v, 3), \"write_full_double_round3.h5\",\"B\")\nh5ls(\"write_full_double_round3.h5\")\n\nfile.info(\"write_full_double_round3.h5\")\nv2 <- h5read(\"write_full_double_round3.h5\",\"B\")\nhead(v2)\n\nh5createFile(\"write_full_double_round2.h5\")\nh5write(round(v, 2), \"write_full_double_round2.h5\",\"B\")\nh5ls(\"write_full_double_round2.h5\")\n\nv2 <- h5read(\"write_full_double_round2.h5\",\"B\")\nhead(v2)\n\nh5createFile(\"write_full_double_round1.h5\")\nh5write(round(v, 1), \"write_full_double_round1.h5\",\"B\")\nh5ls(\"write_full_double_round1.h5\")\n\nv2 <- h5read(\"write_full_double_round1.h5\",\"B\")\nhead(v2)\n\nh5createFile(\"write_full_2decimal100.h5\")\nh5write(as.integer(round(v, 2)*100), \"write_full_2decimal100.h5\",\"B\")\nh5ls(\"write_full_2decimal100.h5\")\n\nv2 <- h5read(\"write_full_2decimal100.h5\",\"B\")\nhead(v2)\n\nh5createFile(\"write_full_1decimal10.h5\")\nh5write(as.integer(round(v, 1)*10), \"write_full_1decimal10.h5\",\"B\")\nh5ls(\"write_full_1decimal10.h5\")\n\nv2 <- h5read(\"write_full_1decimal10.h5\",\"B\")\nhead(v2)\n\nC = matrix(paste(LETTERS[1:10],LETTERS[11:20], collapse=\"\"),\n           nr=2,nc=5)\nh5write(C, \"myhdf5file.h5\",\"foo/foobaa/C\")\ndf = data.frame(1L:5L,seq(0,1,length.out=5),\n                c(\"ab\",\"cde\",\"fghi\",\"a\",\"s\"), stringsAsFactors=FALSE)\nh5write(df, \"myhdf5file.h5\",\"df\")\nh5ls(\"myhdf5file.h5\")\n\n\nh5ls(\"/home/rte_tst/data/hdf5_2/2013_9.h5\")\n\n\nrhdf5::H5close()\n\nh5createFile(\"subset_data_frame.h5\")\n\nd <- data.frame(x = rnorm(100), y= c(\"Apolp\", \"oinif\"), stringsAsFactors = FALSE)\n\nh5writeDataset(d, \"subset_data_frame.h5\",\"d3\", DataFrameAsCompound = T)\nh5ls(\"subset_data_frame.h5\")\n\nh5read(\"subset_data_frame.h5\", \"d\")\n\nh5\n\n#-----------------------\n# matrix subset\n#-----------------------\nd <- matrix(rnorm(10000000), ncol = 10)\n\nh5createFile(\"ex_createDataset.h5\")\nh5write(d, \"ex_createDataset.h5\",\"A\", level = 5)\n\n\n\n# # create dataset with row paquets\n# h5createDataset(\"ex_createDataset.h5\", \"B\", dim(d), storage.mode = storage.mode(d), chunk=c(1000,1), level=7)\n# system.time(h5write(d, file=\"ex_createDataset.h5\", name=\"B\"))\n\n# user  system elapsed \n# 1.972   1.932   3.937 \n\n# create dataset with compression, column  chunk\nh5createDataset(\"ex_createDataset.h5\", \"C\", dim(d), storage.mode = storage.mode(d), chunk=c(nrow(d),1), level=7)\nsystem.time(h5write(d, file=\"ex_createDataset.h5\", name=\"C\"))\n# user  system elapsed \n# 3.536   2.316   5.863 \n\n# create dataset with compression, row  chunk\nh5createDataset(\"ex_createDataset.h5\", \"D\", dim(d), storage.mode = storage.mode(d), chunk=c(1,ncol(d)), level=7)\nsystem.time(h5write(d, file=\"ex_createDataset.h5\", name=\"D\"))\n\nh5createAttribute(fid, \"rownames\", nrow(obj), storage.mode=\"character\",\n                  size=max(nchar(rownames(obj))))\nh5createAttribute(fid, \"colnames\", ncol(obj), storage.mode=\"character\",\n                  size=max(nchar(colnames(obj))))\n\nh5writeDataset(obj, fid, name)\nh5writeAttribute(rownames(obj), did, \"rownames\")\nh5writeAttribute(colnames(obj), did, \"colnames\")\n\n\n# create dataset with compression, row  chunk\nh5createDataset(\"ex_createDataset.h5\", \"F\", dim(d), storage.mode = storage.mode(d), chunk=c(10000,5), level=7)\nsystem.time(h5write(d, file=\"ex_createDataset.h5\", name=\"F\"))\n\n# user  system elapsed \n# 35.972  19.600  50.219 \n\n\nsystem.time(read_all <- h5read(\"ex_createDataset.h5\",\"A\"))\nsystem.time(read_all2 <- h5read(\"ex_createDataset.h5\",\"B\"))\nsystem.time(read_all3 <- h5read(\"ex_createDataset.h5\",\"C\"))\n# system.time(read_all4 <- h5read(\"ex_createDataset.h5\",\"D\"))\nsystem.time(read_all4 <- h5read(\"ex_createDataset.h5\",\"F\"))\n\ndim(read_all)\nhead(read_all)\n\n# subset on row\nsystem.time(read_sr <- h5read(\"ex_createDataset.h5\",\"A\", index = list(seq(1, 1000000, by = 200), NULL)))\nsystem.time(read_sr <- h5read(\"ex_createDataset.h5\",\"B\", index = list(seq(1, 1000000, by = 200), NULL)))\nsystem.time(read_sr <- h5read(\"ex_createDataset.h5\",\"C\", index = list(seq(1, 1000000, by = 200), NULL)))\n# system.time(read_sr <- h5read(\"ex_createDataset.h5\",\"D\", index = list(seq(1, 1000000, by = 500), NULL)))\nsystem.time(read_sr <- h5read(\"ex_createDataset.h5\",\"F\", index = list(seq(1, 1000000, by = 200), NULL)))\n\n# subset on column\nsystem.time(read_sc <- h5read(\"ex_createDataset.h5\",\"A\", index = list(NULL, c(1,3,5,9))))\nsystem.time(read_sc <- h5read(\"ex_createDataset.h5\",\"B\", index = list(NULL, c(1,3,5,9))))\nsystem.time(read_sc <- h5read(\"ex_createDataset.h5\",\"C\", index = list(NULL, c(1,3,5,9))))\n# system.time(read_sc <- h5read(\"ex_createDataset.h5\",\"D\", index = list(NULL, c(1,3,5))))\nsystem.time(read_sc <- h5read(\"ex_createDataset.h5\",\"F\", index = list(NULL, c(1,3,5,9))))\n\n# subset on column\nsystem.time(read_sc <- h5read(\"ex_createDataset.h5\",\"A\", index = list(NULL, c(1,3))))\nsystem.time(read_sc <- h5read(\"ex_createDataset.h5\",\"B\", index = list(NULL, c(1,3))))\nsystem.time(read_sc <- h5read(\"ex_createDataset.h5\",\"C\", index = list(NULL, c(1,3))))\n# system.time(read_sc <- h5read(\"ex_createDataset.h5\",\"D\", index = list(NULL, c(1,3,5))))\nsystem.time(read_sc <- h5read(\"ex_createDataset.h5\",\"F\", index = list(NULL, c(1,3))))\n\n# subset on row & column\nsystem.time(read_sc <- h5read(\"ex_createDataset.h5\",\"A\", index = list(seq(1, 1000000, by = 500), c(1,3,5))))\nsystem.time(read_sc <- h5read(\"ex_createDataset.h5\",\"B\", index = list(seq(1, 1000000, by = 500), c(1,3,5))))\nsystem.time(read_sc <- h5read(\"ex_createDataset.h5\",\"C\", index = list(seq(1, 1000000, by = 500), c(1,3,5))))\nsystem.time(read_sc <- h5read(\"ex_createDataset.h5\",\"D\", index = list(seq(1, 1000000, by = 500), c(1,3,5))))\n\ndim(read_sr)\nhead(read_sr)\n\nh5ls(\"ex_createDataset.h5\")\n\n\n#-----------------------\n# data.frame subset\n\n#-----------------------\nd <- data.frame(matrix(rnorm(10000000), ncol = 10))\nh5createFile(\"ex_df.h5\")\nsystem.time(h5write(d, \"ex_df.h5\",\"A\", level = 5))\n\n\nd <- matrix(rnorm(10000000), ncol = 10)\ncolnames(d) <- paste0(\"X\", 1:10)\nh5createFile(\"ex_mat.h5\")\nsystem.time(h5write(d, \"ex_mat.h5\",\"A\", level = 5))\n\ndid <- H5Dopen(\"ex_mat.h5\",\"A\")\n\nh5writeAttribute(colnames(d), H, \"rownames\")\n\n\n# create dataset with row paquets\ntt <- h5read(\"ex_mat.h5\",\"A\", read.attributes=TRUE)\nhead(tt)\n\nsystem.time(d2 <- h5read(\"ex_df.h5\",\"A\"))\nhead(d2)\n\nsystem.time(d3 <- h5read(\"ex_mat.h5\",\"A\"))\nhead(d3)\n\n\nh5createFile(\"ex_ff.h5\")\n\nh5write(c(\"a\", \"b\"), \"ex_ff.h5\",\"A\", level = 5)\nh5read(\"ex_ff.h5\",\"A\")\n",
    "created" : 1497866092460.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "1182851782",
    "id" : "DD906547",
    "lastKnownWriteTime" : 1497515955,
    "last_content_update" : 1497515955,
    "path" : "D:/Users/titorobe/Desktop/Antares/antaresHdf5/inst/dev/test_hdf5.R",
    "project_path" : "inst/dev/test_hdf5.R",
    "properties" : {
    },
    "relative_order" : 18,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_source"
}